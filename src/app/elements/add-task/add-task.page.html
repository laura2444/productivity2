<ion-header class="custom-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="closeModal()" class="close-button">
        <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="header-title">Nueva Tarea</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="addTask()" class="save-button" strong="true">
        <ion-icon name="checkmark" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="task-edit-content">
  <div class="edit-container">
    <!-- Tarjeta de info -->
    <ion-card class="info-card">
      <ion-card-content>
        <div class="title-section">
          <ion-icon name="create-outline" class="section-icon"></ion-icon>
          <ion-item lines="none" class="title-input">
            <ion-input 
              [(ngModel)]="newTask.title" 
              placeholder="Título de la tarea"
              class="title-field">
            </ion-input>
          </ion-item>
        </div>

        <div class="description-section">
          <ion-icon name="document-text-outline" class="section-icon"></ion-icon>
          <ion-textarea
            [(ngModel)]="newTask.description"
            placeholder="Descripción..."
            autoGrow="true"
            class="description-field">
          </ion-textarea>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Detalles -->
    <div class="details-group">
      <h3 class="section-title">
        <ion-icon name="calendar-outline"></ion-icon>
        Fechas y hora
      </h3>
      
      <!-- Selector de Fecha -->
      <ion-item lines="none" button detail="false" (click)="openDatePicker()" class="detail-item">
        <ion-icon name="calendar-outline" slot="start" class="detail-icon"></ion-icon>
        <ion-label class="detail-label">Fecha</ion-label>
        <ion-text slot="end" class="detail-value">
          {{ newTask.date ? (newTask.date | date:'dd/MM/yyyy') : 'Seleccionar' }}
        </ion-text>
      </ion-item>

      <!-- Selector de Hora -->
      <ion-item lines="none" button detail="false" (click)="openTimePicker()" class="detail-item">
        <ion-icon name="time-outline" slot="start" class="detail-icon"></ion-icon>
        <ion-label class="detail-label">Hora</ion-label>
        <ion-text slot="end" class="detail-value">
          {{ newTask.time || 'Seleccionar' }}
        </ion-text>
      </ion-item>
    </div>

    <!-- Clasificación -->
    <div class="details-group">
      <h3 class="section-title">
        <ion-icon name="pricetags-outline"></ion-icon>
        Clasificación
      </h3>

      <ion-item lines="none" class="detail-item">
        <ion-icon name="pricetag-outline" slot="start" class="detail-icon"></ion-icon>
        <ion-label class="detail-label">Etiqueta</ion-label>
        <ion-select 
          [(ngModel)]="newTask.label" 
          interface="action-sheet" 
          class="category-select">
          <ion-select-option value="Trabajo">Trabajo</ion-select-option>
          <ion-select-option value="Personal">Personal</ion-select-option>
          <ion-select-option value="Otro">Otro</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item lines="none" class="detail-item">
        <ion-icon name="flag-outline" slot="start" class="detail-icon"></ion-icon>
        <ion-label class="detail-label">Prioridad</ion-label>
        <ion-select 
          [(ngModel)]="newTask.priority" 
          interface="action-sheet"
          class="priority-select">
          <ion-select-option value="Alta">Alta</ion-select-option>
          <ion-select-option value="Media">Media</ion-select-option>
          <ion-select-option value="Baja">Baja</ion-select-option>
        </ion-select>
      </ion-item>
    </div>
  </div>

  <!-- Modals para fecha y hora -->
  <ion-modal [isOpen]="showDatePicker" (didDismiss)="showDatePicker = false">
    <ng-template>
      <ion-datetime 
        [(ngModel)]="newTask.date"
        presentation="date"
        (ionChange)="dateSelected($event)">
      </ion-datetime>
    </ng-template>
  </ion-modal>

  <ion-modal [isOpen]="showTimePicker" (didDismiss)="showTimePicker = false">
    <ng-template>
      <ion-datetime 
        [(ngModel)]="newTask.time"
        presentation="time"
        (ionChange)="timeSelected($event)">
      </ion-datetime>
    </ng-template>
  </ion-modal>
</ion-content>